openapi: 3.0.0
info:
  title: Personstatus API
  version: 1.0.0
  description: API for å hente personstatus for dagpengebrukere
  contact:
    name: '#team-dagpenger-rapportering'
servers:
  - url: https://dp-rapportering-personregister.intern.dev.nav.no
    description: dev
  - url: https://dp-rapportering-personregister.intern.nav.no
    description: prod
paths:
  /personstatus:
    get:
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonStatus'
        404:
          description: Not Found
      summary: Hent personstatus
      description: Hent personstatus for en dagpengebruker
      operationId: get-personstatus
      security:
        - tokenX: []

  /hentPersonId:
    post:
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonIdBody'
        404:
          description: Not Found
      summary: Hent ID til en person
      description: Hent ID til en person basert på ident
      operationId: post-hentPersonId
      requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentBody'
      security:
        - azureAd: []

  /hentIdent:
    post:
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IdentBody'
        404:
          description: Not Found
      summary: Hent ident til en person
      description: Hent ident til en person basert på ID
      operationId: post-hentIdent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PersonIdBody'
      security:
        - azureAd: []

  /arbeidssokerperioder/{personId}:
    get:
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Arbeidssokerperiode'
        404:
          description: Not Found
      summary: Hent arbeidssøkerperioder for en person
      description: Hent alle arbeidssøkerperioder for en person basert på personId
      operationId: get-arbeidssokerperioder
      parameters:
        - in: path
          name: personId
          schema:
            type: string
          required: true
          description: personId til personen du vil hente arbeidssøkerperioder for
      security:
        - azureAd: []


components:
  schemas:
    IdentBody:
      required:
        - ident
      type: object
      properties:
        ident:
          type: string
    PersonIdBody:
      required:
        - personId
      type: object
      properties:
        personId:
          type: integer
    PersonStatus:
      required:
        - ident
        - status
        - overtattBekreftelse
      type: object
      properties:
        ident:
          type: string
        status:
          $ref: '#/components/schemas/Status'
        overtattBekreftelse:
          type: boolean
        ansvarligSystem:
          $ref: '#/components/schemas/AnsvarligSystem'
    Status:
      type: string
      enum:
        - DAGPENGERBRUKER
        - IKKE_DAGPENGERBRUKER
    AnsvarligSystem:
      type: string
      enum:
        - ARENA
        - DP
    Arbeidssokerperiode:
      required:
        - periodeId
        - ident
        - startDato
        - status
      type: object
      properties:
        periodeId:
          type: string
          description: Unik ID for arbeidssøkerperioden
        ident:
          type: string
          description: Ident til personen arbeidssøkerperioden tilhører
        startDato:
          type: string
          format: date-time
          description: Startdato for arbeidssøkerperioden
        sluttDato:
          type: string
          format: date-time
          description: Sluttdato for arbeidssokerperioden, kan være null hvis perioden er aktiv
        status:
          type: string
          enum:
            - Startet
            - Avsluttet
          description: Status for arbeidssøkerperioden
    Problem:
      type: object
      description: Implementasjon av Problem Details for HTTP APIs [RFC 7807](https://datatracker.ietf.org/doc/html/rfc7807)
      properties:
        type:
          type: string
          format: uri
          default: about:blank
          description: URI som identifiserer problemet
        title:
          type: string
          description: En kort oppsummering av problemet
        status:
          type: integer
          description: HTTP status
        detail:
          type: string
          description: Forklaring av problemet
        instance:
          type: string
          format: uri
          description: Hvor feilen oppstod
  securitySchemes:
    tokenX:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Bruker [TokenX](https://docs.nais.io/security/auth/tokenx/) til autentisering. Du må utveksle IDporten-token
        til et TokenX-token hvor `audience` er satt til `[cluster]:teamdagpenger:dp-rapportering-personregister`.
        
        For å teste APIet kan du lage et gyldig OBO-token ved å bruke wonderwalled:
        - [dev-gcp](https://wonderwalled-idporten.intern.dev.nav.no/api/obo?aud=dev-gcp:teamdagpenger:dp-rapportering-personregister)
    azureAd:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Bruker Azure AD til autentisering for saksbehandlere. Token må ha riktig tilganger.
  headers: { }
  responses: { }
